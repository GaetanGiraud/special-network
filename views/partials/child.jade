div(class= 'row')
  div(class="span5")
    legend {{child.name}}
    
    div.row
      div.span3
        img#picture.well(width="200", ng-src="{{ child.picture | picture }}")
      div.span2
        small
          | <strong>Drag & Drop</strong> the file onto the existing picture or
          br
          | Use the <strong>button</strong> to change your profile picture.
        br
        span.btn.btn-success.fileinput-button
          i.icon-plus.icon-white
          span 
            | New picture
            input(type="file", uploader, done='setProfilePicture(file)', data-url="/upload")
    div
      h5 My Specialties
      ul.unstyled
        li(ng-repeat = 'specialty in child.specialties')
          | {{ specialty }}
          button(ng-click = 'removeSpecialty($index)') &times
        li
          autocomplete(results = 'child.newSpecialty', url = '/api/discussions/search?type=groups', create = 'addSpecialty(string)')
          button.btn(ng-click = 'addSpecialty()') Add
          button.btn(ng-click = 'child.newSpecialty = ""') Cancel
      
    div
      h5 My Superpowers
      ul.unstyled
        li(ng-repeat = 'superpower in child.superpowers')
           | {{ superpower }}
           button(ng-click = 'removeSuperpower($index)') &times
        li 
          autocomplete(results = 'child.newSuperpower', url = '/api/discussions/search?type=tags', create = 'addSuperpower(string)')
          button.btn(ng-click = 'addSuperpower()') Add
          button.btn(ng-click = 'child.newSuperpower = ""') Cancel
    
    button(type='button', ng-click="updateUser()", class='btn btn-primary') Update
    button(type='button', ng-click="cancelUpdate()", class='btn', title = 'All changes will be lost!') Cancel

  div.span5
    article#new-question
      h5 Publish an update
      
      div.content
        div.editable(contenteditable = 'true', ng-model = "newDiscussion.content")
        div.btn-group.fileupload-buttonbar.footer
          span.fileinput-button 
            button.btn(type = "button", ng-click = "createUpdate()") Post
          span.btn.fileinput-button 
            i.icon-picture.icon-white
              input(type = "file", uploader, done = "", data-url="/upload", name="file")
          span.btn.fileinput-button 
            i.icon-film.icon-white
              input(type = "file", uploader, done = "", data-url="/upload", name="file")
       
    //Existing discussions
    
    div(ng-repeat = "discussion in discussions | orderBy:'createdAt':true")
      h4
        img(ng-src = '{{ discussion._creator | iconPicture }}')
        | {{discussion._creator.name}} 
        | {{ $index }}
      h5 {{discussion.type}} 
      ul
        li(ng-repeat = "child in discussion.children")
          | {{child.name}}
        
      p(ng-bind-html = 'discussion.content')
        
      div.comment(ng-repeat =  'comment in discussion.comments | orderBy:"createdAt":false')
        h5 {{comment._creator.name}}
        p(ng-bind-html = 'comment.content')
      
      div(ng-controller = 'newCommentCtrl')
        a(ng-show = "!reply", ng-click="reply = true") Reply
        div.footer(ng-show = "reply")
          textarea(ng-model = "newComment.content") 
          br
          button.btn.btn-primary(ng-click="createComment($index)") Post 
          button.btn(ng-click="reply = false") Cancel

